#!/usr/bin/env python
"Pump one drop of water"

import time
import argparse 
from pathlib import Path
import RPi.GPIO as GPIO
from experiment.helpers import read_config
GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(False)

parser = argparse.ArgumentParser(__doc__)
parser.add_argument("-c", "--config-path",
        help="Config path",
        dest="config_path", default="configs.toml", type=lambda x: Path(x).expanduser().absolute())
        
args = parser.parse_args()
config_path = args.config_path

configs = read_config(config_path)

pump_pin = int(configs["experiment"]["pins"]["pump"])
GPIO.setup(pump_pin, GPIO.OUT)
GPIO.output(pump_pin, True)
input("Press Enter to close the pump\n> ")
